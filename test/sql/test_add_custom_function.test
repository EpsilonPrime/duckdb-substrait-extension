# name: test/sql/test_add_custom_function.test
# description: Test that using ADD gives the correct extension info
# group: [substrait]

require substrait

statement ok
PRAGMA enable_verification

statement ok
create table t (a integer)

statement ok
insert into t values (1)

query I
CALL get_substrait_json('select sum(a) from t')
----
{"extensions":[{"extensionFunction":{"functionAnchor":1,"name":"sum"}}],"relations":[{"root":{"input":{"project":{"input":{"aggregate":{"input":{"read":{"baseSchema":{"names":["a"],"struct":{"types":[{"i32":{"nullability":"NULLABILITY_NULLABLE"}}],"nullability":"NULLABILITY_REQUIRED"}},"projection":{"select":{"structItems":[{}]},"maintainSingularStruct":true},"namedTable":{"names":["t"]}}},"groupings":[{}],"measures":[{"measure":{"functionReference":1,"outputType":{"decimal":{"precision":38,"nullability":"NULLABILITY_NULLABLE"}},"arguments":[{"value":{"selection":{"directReference":{"structField":{}},"rootReference":{}}}}]}}]}},"expressions":[{"selection":{"directReference":{"structField":{}},"rootReference":{}}}]}},"names":["sum(a)"]}}],"version":{"minorNumber":24,"producer":"DuckDB"}}
